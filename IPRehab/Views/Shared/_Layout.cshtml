<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="author" content="Chun Jonathan Sun" />
    <meta name="description" content="A modern reponsive web app for the Rehabilitation and Prosthetic Services to track In Patient rehabilitation on progress stages based on Deparment of Health and Human Services Center for Medicare and Medicaid Services form IRF-PAI V4" />
    <meta name="keywords" content="In Patient, Rehabilitation, Rehab, C#, MVC, Bootstrap, Material IO, JQuery, Entity Framework, Restful Web API, Repository" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - IPRehab</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/6.0.0/normalize.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />

    @await RenderSectionAsync("VendorStyles", required: false)

    <environment include="Production">

        @* css bundled minified production version *@
        <link rel="stylesheet" href="~/css/siteBundle.min.css" />
        @await RenderSectionAsync("MyStyles_prod", required: false)

    </environment>

    <environment include="Development">

        @* css unbundled unminified development version *@
        <link href="~/css/site.css" asp-append-version="true" rel="stylesheet" />
        <link href="~/css/transition.css" asp-append-version="true" rel="stylesheet" />
        <link href="~/css/app.css" asp-append-version="true" rel="stylesheet" />
        @*<link href="~/css/cube annimation/cube.css" asp-append-version="true" rel="stylesheet"/>*@
        @await RenderSectionAsync("MyStyles_dev", required: false)

    </environment>
</head>
<body>
    <header>
        <nav class="banner vbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3 fixed-top hoverHeader">
            <div class="flex-container-evenly-justified">
                <div id="logo"></div>
                <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">Inpatient Rehab Assessment Tool</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                    <ul class="navbar-nav flex-grow-1">
                        <li class="nav-item">
                            <a class="nav-link" asp-area="" asp-controller="Home" asp-action="Index">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
                        </li>
                    </ul>
                    @*<partial name="_LoginPartial" />*@
                    <ul class="navbar-nav flex-grow-1">
                        <li class="nav-item">
                            <span>@($"{ViewBag.CurrentUserName} ({ViewBag.CurrentUserID})")</span>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="flex-center">
            <div class="pulldown" title="Main menu"><i class="fa fa-caret-down fa-2x" aria-hidden="true"></i></div>
        </div>
    </header>

    <main role="main">
        @*<div class="parallax"></div>*@
        <div class="content-outer">
            <div class="content-inner">
                <div class="container">
                    <aside>
                        <div class="spinnerContainer">
                            <img id="chiropractor" src="~/images/chiropractor_jumping_on_table_lg_clr.gif" alt="Chiroprctor jumping on table" />
                            @*<div class="cube">
                            <div class="sides">
                            <div class="top"></div>
                            <div class="right"></div>
                            <div class="bottom"></div>
                            <div class="left"></div>
                            <div class="front"></div>
                            <div class="back"></div>
                            </div>
                            </div>*@
                        </div>
                    </aside>
                    @RenderBody()
                    <aside>
                        <partial name="_CookieConsentPartial" />
                    </aside>
                </div>
            </div>
        </div>
    </main>

    <footer class="border-top footer text-muted hoverFooter">
        <div class="flex-container-evenly-justified">
            <div class="text-white">IPRehab @ViewBag.GitVersion | Powered by VSSC-Business Apps Team | <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a></div>
            <div class="text-white">Sponsered by @ViewBag.Office&nbsp;</div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
            integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>

    @* page specific vendor script *@
    @await RenderSectionAsync("VendorScripts", required: false)

    <environment include="Production">
        @* js bundled minified production version *@
        <script type="module" src="~/js/siteJsBundle.min.js" asp-append-version="true" async></script>
        @await RenderSectionAsync("MyScripts_block1_prod", required: false)
    </environment>

    <environment include="Development">
        @* js unbundled unminified development version *@
        <script type="module" src="~/js/app/animateBanner.js" asp-append-version="true" async></script>
        <script type="module" src="~/js/app/cookieConsent.js" asp-append-version="true" async></script>
        @await RenderSectionAsync("MyScripts_block1_dev", required: false)
    </environment>

    <script type="text/JavaScript" asp-append-version="true">
        $(function () {
            $('.spinnerContainer').hide();
        })

        $('.rehabAction').on('click', function () {
            $('.spinnerContainer').show();
        })

        //window.onbeforeunload = function (e) { pageUnload(); };

        //window.onbeforeunload = function (e) {
        //  console.log('window.onbeforeunload event', e);
        //  var msg = "You are leaving this page! Click the save button, if visible."
        //  var e = e || window.event;
        //     if (e) { e.returnValue = msg; }
        //  return msg;
        //};

        // $(window).on("unload", function (e) {
        //     console.log('(window).on("unload") event', e);
        //     pageUnload(e);
        // });

        function pageUnload(e) {
            var performanceNavigationTiming = window.performance.getEntriesByType("navigation")[0];

            console.log('pageUnload(e) event', e);
            console.log('performanceNavigationTiming', performanceNavigationTiming.entryType);
            switch (performanceNavigationTiming.entryType) {
                case 'navigation':
                case 'reload':
                case 'back_forward':
                    var saveButton = $('#saveButton');
                    var episodeNotSaved = $('#episodeID_legend').text() == 'New Episode' || !saveButton.is(":disabled");
                    var msg = "You are leaving this page! Click the SAVE button, if visible."
                    console.log(msg);
                    if (episodeNotSaved) {
                        $('.spinnerContainer').hide();
                        var e = e || window.event;
                        if (e) { e.returnValue = msg; }
                        return msg;
                    }
                    break;
            }
        }
    </script>

    <environment include="Production">
        @* js bundled minified production version *@
        @await RenderSectionAsync("MyScripts_block2_prod", required: false)
    </environment>

    <environment include="Development">
        @* js unbundled unminified development version *@
        @await RenderSectionAsync("MyScripts_block2_dev", required: false)
    </environment>
</body>
</html>
