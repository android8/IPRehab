import{Utility}from"./commonImport.js";var EnumChangeEventArg;!function(e){e.Load="Load",e.Change="Change",e.NoScroll="NoScroll"}(EnumChangeEventArg||(EnumChangeEventArg={}));const branchingController=function(){const e=new Utility,n=e.dialogOptions();return{LoadAllRules:function(){console.log("branching:::","Inside of LoadAllRules() loadEventData"),function(){function o(o){var i,s,t;console.log("e.data.x in check!12_23() = ",null===(i=o.data)||void 0===i?void 0:i.x);const l=$(".persistable[id^=Q12_]"),a=$(".persistable[id^=Q23]"),r=$(".persistable:not([id^=Q12_]):not([id^=Q23])"),c={Ok:function(){r.each(function(){$(this).prop("disabled",!0)}),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};if(e.isEmpty(l)||e.isEmpty(a))console.log("Q12 or Q23 is empty or both, lock all other questions"),(null===(s=o.data)||void 0===s?void 0:s.x)===EnumChangeEventArg.Change?(n.title="Date",$("#dialog").text("Onset Date and Admit Date are record keys, when either is blank, all fields with current values will be locked").dialog(n,{title:"Warning",buttons:c})):r.each(function(){$(this).prop("disabled",!0)});else{const e=new Date("2020-01-01 00:00:00"),i=new Date(a.val()),s=new Date(l.val());i<e||s<e||s<i?(console.log("Onset Date and Admit Date must be later than 01/01/2021, and Admit Date must be on Onset Date or later"),(null===(t=o.data)||void 0===t?void 0:t.x)===EnumChangeEventArg.Change?(n.title="Date",$("#dialog").text("Onset Date and Admit Date must be later than 01/01/2021, and Admit Date must be on Onset Date or later").dialog(n,{title:"Warning",buttons:c})):r.each(function(){$(this).prop("disabled",!0)})):(console.log("Onset Date and Admit Date are not empty, apply rules of other "+r.length+" perPersistables"),r.each(function(){$(this).prop("disabled",!1),$(this).change()}))}}console.log("branching:::","Inside of Q12_Q23_blank_then_Lock_All()"),$(".persistable[id^=Q12_], .persistable[id^=Q23]").each(function(){$(this).on("change",{x:EnumChangeEventArg.Change},o)}),o(EnumChangeEventArg.Load)}(),function(){console.log("branching::: inside of Q12B_blank_then_Lock_Discharge");const o=$(".persistable[id^=Q12B_]");function i(i){var s,t;console.log("inside of checkQ12B(e) Q12B.val()",o.val());const l=""!==(null===(s=o.val())||void 0===s?void 0:s.toString()),a=$(".persistable[id ^= Q15B],.persistable[id ^= Q16B],.persistable[id ^= Q17B],.persistable[id ^= Q21B],.persistable[id ^= Q41],.persistable[id ^= Q44C]");if(l)console.log("Q12B is a discharge date, unlock all discharged Qs in the base series only, not other questions in other series"),a.each(function(){$(this).prop("disabled",!1)});else if(console.log("Q12B is not a discharge date, lock all related discharged Q series",a),(null===(t=i.data)||void 0===t?void 0:t.x)===EnumChangeEventArg.Change){const o={Ok:function(){a.each(function(){const n=$(this);e.resetControlValue(n),n.prop("disabled",!0)}),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};n.title="Date",$("#dialog").text("Reseting discharge date also reset the following related discharge fields:  Q15B,Q16B, Q17B, Q21B, Q41, Q44C").dialog(n,{title:"Warning",buttons:o})}else a.each(function(){const n=$(this);e.resetControlValue(n),n.prop("disabled",!0)})}o.on("change",{x:EnumChangeEventArg.Change},i),i(EnumChangeEventArg.Load)}(),function(){function e(e){var o,i;console.log("inside of checkQ14A(e)",e);const s=1===$(".persistable[id^=Q14A_][id*=Yes]:checked").length,t=$(".persistable[id^=Q14B_]");if(s){if(console.log("Q14A is Yes, unlock all Q14B and focus on first Q14B"),t.length>0){if((null===(o=e.data)||void 0===o?void 0:o.x)===EnumChangeEventArg.Change){const e={Ok:function(){t.each(function(){$(this).prop("disabled",!1)}),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};n.title="Date",$("#dialog").text("14A is Yes, unlock all Q14B and focus on first Q14B").dialog(n,{title:"Warning",buttons:e})}else t.each(function(){$(this).prop("disabled",!1)});t.first().focus()}}else if(console.log("Q14A is not answered or is No, uncheck and lock all Q14B"),(null===(i=e.data)||void 0===i?void 0:i.x)===EnumChangeEventArg.Change){const e={Ok:function(){t.each(function(){$(this).prop("checked",!1).prop("disabled",!0)}),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};n.title="Date",$("#dialog").text("Q14A is not answered or is No, uncheck and lock all Q14B").dialog(n,{title:"Warning",buttons:e})}else t.each(function(){$(this).prop("checked",!1).prop("disabled",!0)})}console.log("branching::: inside of Q14B_enabled_if_Q14A_is_Yes"),$(".persistable[id^=Q14A_]").on("change",{x:EnumChangeEventArg.Change,id:$(this).prop("id")},e),e(EnumChangeEventArg.Load)}(),function(){console.log("branching::: inside of Q14B_enabled_if_Q14A_is_Yes");const o=$(".persistable[id^=Q16A_]"),i=-1===$(".persistable[id^=Q16A_] option:selected").text().indexOf("1. Home"),s=$(".persistable[id^=Q17_]");function t(n){n?(e.resetControlValue(s),s.prop("disabled",n),e.resetControlValue(s.next(),"")):s.prop("disabled",n).focus()}function l(e){var o;if(i){const i=!0;if(s.length>0)if((null===(o=e.data)||void 0===o?void 0:o.x)===EnumChangeEventArg.Change){const e={Ok:function(){t(i),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("Q16A is not home, clear and lock Q17").dialog(n,{title:"Warning",buttons:e})}else t(i)}else{console.log("Q16A is home, unlock and focus on Q17");const o=!1;if(s.length>0&&e===EnumChangeEventArg.Change){const e={Ok:function(){t(o),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("Q16A is home, unlock and focus on Q17").dialog(n,{title:"Warning",buttons:e})}}}o.on("change",{x:EnumChangeEventArg.Change},l),l(EnumChangeEventArg.Load)}(),function(){function e(e){$(".persistable[id^=Q43_]").each(function(){const n=$(this);e?n.prop("disabled",!0):(console.log("unlock Q43 then raise Q43.change()"),n.prop("disabled",!1).change())})}function o(o){var i;const s=1===$(".persistable[id^=Q42][id*=Yes]:checked").length,t=s?"Q42 is a Yes, unlock all Q43 till the first blank":"Q42 is a No, reset and lock all Q43";if(console.log(s?"Q42 is a Yes, unlock all Q43 till the first blank":"Q42 is a No, reset and lock all Q43"),(null===(i=o.data)||void 0===i?void 0:i.x)===EnumChangeEventArg.Change){const o={Ok:function(){e(!s),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text(t).dialog(n,{title:"Warning",buttons:o})}else e(!s)}console.log("branching::: inside of Q42_Interrupted_then_Q43"),$(".persistable[id^=Q42_]").each(function(){$(this).on("change",{x:EnumChangeEventArg.Change},o)}),o(EnumChangeEventArg.Load)}(),function(){function o(e,n){switch(console.log("thisQ43 in act43s()",n),e){case"D":n.prop("disabled",!0),n.nextAll().each(function(){$(this).val("").prop("disabled",!0)}),0===$('.persistable[id^=Q43][value!=""]').length&&$(".persistable[id=^Q42][id*=No").prop("checked",!0);break;case"CU":n.nextAll(".persistable").each(function(){const e=$(this);if(""===e.val())return e.prop("disabled",!1).focus(),e.next().prop("disabled",!1),!1})}}function i(i){var s,t,l,a;const r=1===$(".persistable[id^=Q42][id*=Yes]:checked").length;console.log("e.data.y in Q43_Rules().checkQ43() =",null===(s=i.data)||void 0===s?void 0:s.y);let c=!1,d=null===(t=i.data)||void 0===t?void 0:t.y;if(r){const s=e.getCRUD(d,d.val(),d.data("oldvalue"));if(console.log("thisQ43CRUD ? "+s==void 0?"unchanged":s),(null===(l=i.data)||void 0===l?void 0:l.x)!==EnumChangeEventArg.Change||c)switch(s){case"D1":case"D1":o("D",d);break;default:o("CU",d)}else switch(s){case"D1":case"D2":{console.log("D1 or D2");const e={Ok:function(){o("D",d),$(this).dialog("close"),c=!0},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("Find next blank Q43 for editing").dialog(n,{title:"Warning",buttons:e});break}default:{console.log("C,U,and default");const e={Ok:function(){o("CU",d),$(this).dialog("close"),c=!0},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("Find next blank Q43 for editing").dialog(n,{title:"Warning",buttons:e});break}}}else if((null===(a=i.data)||void 0===a?void 0:a.x)!==EnumChangeEventArg.Change||c)e.resetControlValue(d),d.prop("disabled",!0);else{const o={Ok:function(){e.resetControlValue(d),d.prop("disabled",!0),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("Find next blank Q43 for editing").dialog(n,{title:"Warning",buttons:o})}}console.log("branching::: inside of Q43_Rules()"),$(".persistable[id^=Q43_]").each(function(){const e=$(this);e.on("change",{x:EnumChangeEventArg.Change,y:e},i)})}(),function(){let o;function i(o){var i;const s=$(".persistable[id^=Q44D_]"),t=$(".persistable[id^=Q45_]"),l=$(".persistable[id^=Q46_]");if(1===$(".persistable[id^=Q44C_][id*=Yes]:checked").length)console.log("Q44C is yes, unlock Q44D, Q45 and focus on Q44D"),s.length>0&&s.prop("disabled",!1).focus(),t.length>0&&t.prop("disabled",!1);else if(console.log("Q44C is no, lock Q44D, Q45 and focus on Q46"),(null===(i=o.data)||void 0===i?void 0:i.x)===EnumChangeEventArg.Change){const o={Ok:function(){s.length>0&&(e.resetControlValue(s),s.prop("disabled",!0)),t.length>0&&t.prop("disabled",!0),l.length>0&&l.prop("disabled",!1).focus(),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("Q44C is no, lock Q44D, Q45 and focus on Q46").dialog(n,{title:"Warning",buttons:o})}else s.length>0&&(e.resetControlValue(s),s.prop("disabled",!0)),t.length>0&&t.prop("disabled",!0),l.length>0&&l.prop("disabled",!1).focus()}console.log("branching::: inside of Q44C_Affect_Q44D_Q46"),$(".persistable[id^=Q44C_]").each(function(){(o=$(this)).on("change",{x:EnumChangeEventArg.Change},i)}),i(EnumChangeEventArg.Load)}(),function(){console.log("branching::: inside of GG0170JKLMN_depends_on_GG0170I");const o=$(".persistable[id^=GG0170I]:not([id*=Discharge_Goal])");let i;function s(n,o,i){n.each(function(){e.resetControlValue($(this)),$(this).prop("disabled",i)}),e.scrollTo(o.first()),o.first().focus()}function t(o){var t,l;const a=e.getControlValue(i);let r,c,d;switch(console.log("commonUtility.getControlValue("+i.prop("id")+") = ",a),-1!==i.prop("id").indexOf("Admission_Performance")?(c=$(".persistable[id^=GG0170J_Admission_Performance], .persistable[id^=GG0170K_Admission_Performance], .persistable[id^=GG0170L_Admission_Performance]"),d=$(".persistable[id^=GG0170M_Admission_Performance]"),r=$(".persistable[id^=GG0170J_Admission_Performance]")):-1!==i.prop("id").indexOf("Discharge_Performance")?(c=$(".persistable[id^=GG0170J_Discharge_Performance], .persistable[id^=GG0170K_Discharge_Performance], .persistable[id^=GG0170L_Discharge_Performance]"),d=$(".persistable[id^=GG0170M_Discharge_Performance]"),r=$(".persistable[id^=GG0170J_Discharge_Performance]")):-1!==i.prop("id").indexOf("Interim_Performance")?(c=$(".persistable[id^=GG0170J_Interim_Performance], .persistable[id^=GG0170K_Interim_Performance], .persistable[id^=GG0170L_Interim_Performance]"),d=$(".persistable[id^=GG0170M_Interim_Performance]"),r=$(".persistable[id^=GG0170J_Interim_Performance]")):-1!==i.prop("id").indexOf("Followup_Performance")&&(c=$(".persistable[id^=GG0170J_Followup_Performance], .persistable[id^=GG0170K_Followup_Performance], .persistable[id^=GG0170L_Followup_Performance]"),d=$(".persistable[id^=GG0170M_Followup_Performance]"),r=$(".persistable[id^=GG0170J_Followup_Performance]")),!0){case a>0&&a<=6:if(console.log("I is between 1 and 6, unlock J, K, L, and advance to J"),(null===(t=o.data)||void 0===t?void 0:t.x)===EnumChangeEventArg.Change){const e={Ok:function(){s(c,r,!1),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("I is less than or equal to 6, unlock J, K, L, and advance t J").dialog(n,{title:"Warning",buttons:e})}else s(c,r,!1);break;default:if(console.log("GG0170I is not answered or not between 1 and 6, clear and lock J K L, then advance to M"),(null===(l=o.data)||void 0===l?void 0:l.x)===EnumChangeEventArg.Change){const e={Ok:function(){s(c,d,!0),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("GG0170I is not answered or not between 1 and 6, clear and lock J K L, then advance to M").dialog(n,{title:"Warning",buttons:e})}else s(c,d,!0)}}o.each(function(){(i=$(this)).on("change",{x:EnumChangeEventArg.Change},t)}),o.each(function(){i=$(this),t(EnumChangeEventArg.Load)})}(),function(){console.log("branching::: inside of GG0170P_depends_on_GG0170M_and_GG0170N");const o=$(".persistable[id^=GG0170M]:not([id*=Discharge_Goal]), .persistable[id^=GG0170N]:not([id*=Discharge_Goal])");let i;function s(o){var s,t,l;console.log("thisMorN",i);const a=e.getControlValue(i);let r,c,d=null,g=null;switch(console.log("determine the trigger is GG0170 M or N",i),-1!==i.prop("id").indexOf("GG0170M")?d=i:g=i,null!=d?(console.log("it's M",d),-1!==d.prop("id").indexOf("Admission_Performance")?(g=$(".persistable[id^=GG0170N_Admission_Performance]"),r=$(".persistable[id^=GG0170O_Admission_Performance]"),c=$(".persistable[id^=GG0170P_Admission_Performance]")):-1!==d.prop("id").indexOf("Discharge_Performance")?(g=$(".persistable[id^=GG0170N_Discharge_Performance]"),r=$(".persistable[id^=GG0170O_Discharge_Performance]"),c=$(".persistable[id^=GG0170P_Discharge_Performance]")):-1!==d.prop("id").indexOf("Interim_Performance")?(g=$(".persistable[id^=GG0170N_Interim_Performance]"),r=$(".persistable[id^=GG0170O_Interim_Performance]"),c=$(".persistable[id^=GG0170P_Interim_Performance]")):-1!==d.prop("id").indexOf("Followup_Performance")&&(g=$(".persistable[id^=GG0170N_Followup_Performance]"),r=$(".persistable[id^=GG0170O_Followup_Performance]"),c=$(".persistable[id^=GG0170P_Followup_Performance]"))):(console.log("it's N",g),-1!==g.prop("id").indexOf("Admission_Performance")?(r=$(".persistable[id^=GG0170O_Admission_Performance]"),c=$(".persistable[id^=GG0170P_Admission_Performance]")):-1!==g.prop("id").indexOf("Discharge_Performance")?(r=$(".persistable[id^=GG0170O_Discharge_Performance]"),c=$(".persistable[id^=GG0170P_Discharge_Performance]")):-1!==g.prop("id").indexOf("Interim_Performance")?(r=$(".persistable[id^=GG0170O_Interim_Performance]"),c=$(".persistable[id^=GG0170P_Interim_Performance]")):-1!==g.prop("id").indexOf("Followup_Performance")&&(r=$(".persistable[id^=GG0170O_Followup_Performance]"),c=$(".persistable[id^=GG0170P_Followup_Performance]"))),!0){case a>=7:if(console.log("I > 7 go to P"),c.length>0)if((null===(s=o.data)||void 0===s?void 0:s.x)===EnumChangeEventArg.Change){const o={Ok:function(){c.length>0&&e.scrollTo(c.first()),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("I > 7 go to P").dialog(n,{title:"Warning",buttons:o})}else e.scrollTo(c.first());break;case a>0&&a<=6:if(console.log("0 < I <= 6 go to N"),g.length>0)if((null===(t=o.data)||void 0===t?void 0:t.x)===EnumChangeEventArg.Change){const o={Ok:function(){c.length>0&&e.scrollTo(g.first()),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("0 < I <= 6 go to N").dialog(n,{title:"Warning",buttons:o})}else e.scrollTo(g.first());break;default:if(console.log("I is blank, disable N and O"),(null===(l=o.data)||void 0===l?void 0:l.x)===EnumChangeEventArg.Change){const e={Ok:function(){g.length>0&&g.prop("disabled",!0),r.length>0&&r.prop("disabled",!0),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};$("#dialog").text("I is blank, disable GG0170N and GG0170O").dialog(n,{title:"Warning",buttons:e})}else g.length>0&&g.prop("disabled",!0),r.length>0&&r.prop("disabled",!0)}}o.each(function(){(i=$(this)).on("change",{x:EnumChangeEventArg.Change},s)}),o.each(function(){i=$(this),s(EnumChangeEventArg.Load)})}(),function(){console.log("branching::: inside of GG0170Q_is_No_skip_to_Complete");const n=$(".persistable[id^=GG0170Q]:not([id*=Discharge_Goal])");let o;function i(n){let o,i=null,s=!0;const t=1===$(".persistable[id^=GG0170Q_Admission_Performance][id*=Yes]:checked").length;s&&t&&(console.log("Q Admission Performance is yes, unlock and focus on R Admission Performance"),i=$(".persistable[id^=GG0170R_Admission]"),console.log("GG0170Rs",i),i.each(function(){$(this).prop("disabled",!1)}),n===EnumChangeEventArg.Change&&e.scrollTo(i.first()),i.first().focus(),s=!1),s&&1===$(".persistable[id^=GG0170Q_Discharge_Performance][id*=Yes]:checked").length&&(console.log("Q Discharge Performance is yes, unlock and focus on R Discharge Performance"),i=$(".persistable[id^=GG0170R_Discharge_Performance]"),console.log("GG0170Rs",i),i.each(function(){$(this).prop("disabled",!1)}),n===EnumChangeEventArg.Change&&e.scrollTo(i.first()),i.first().focus(),s=!1),s&&1===$(".persistable[id^=GG0170Q_Interim_Performance][id*=Yes]:checked").length&&(console.log("Q Interim Performance is yes, unlock and focus on R Interim Performance"),i=$(".persistable[id^=GG0170R_Interim_Performance]"),console.log("GG0170Rs",i),i.each(function(){$(this).prop("disabled",!1)}),n===EnumChangeEventArg.Change&&e.scrollTo(i.first()),i.first().focus(),s=!1),s&&1===$(".persistable[id^=GG0170Q_Followup_Performance][id*=Yes]:checked").length&&(console.log("Q Follow Up Performance is yes, unlock and focus on R Follow Up Performance"),i=$(".persistable[id^=GG0170R_Followup_Performance]"),console.log("GG0170Rs",i),i.each(function(){$(this).prop("disabled",!1)}),n===EnumChangeEventArg.Change&&e.scrollTo(i.first()),i.first().focus(),s=!1),s&&i&&i.length>0&&(console.log("Q Admission Performance is no, lock GG0170Rs, unlock and set focus on Assesment Complete"),i.each(function(){e.resetControlValue($(this)),$(this).prop("disabled",!0)}),(o=$(".persistable[id ^= Assessment][id*=Yes]")).length>0&&(n===EnumChangeEventArg.Change?e.scrollTo(o):o.focus()))}n.each(function(){(o=$(this)).on("change",{x:EnumChangeEventArg.Change},i)}),n.each(function(){o=$(this),i(EnumChangeEventArg.Load)})}(),function(){let n;function o(o){const i=$(".persistable[id^=J1750]"),s=$(".persistable[id^=J1750][id*=Yes]");0===e.getControlValue(n)?(console.log("J0510 is 0, unlock J1750s and focus on J1750 Yes option"),i.each(function(){$(this).prop("disabled",!1)}),o===EnumChangeEventArg.Change&&e.scrollTo(s),s.focus()):(console.log("J0510 is not 0, uncheck all J1750"),i.each(function(){$(this).prop("checked",!1)}))}console.log("branching::: inside of J1750_depends_on_J0510"),$(".persistable[id^=J0510]:not([id*=Discharge_Goal])").each(function(){(n=$(this)).on("change",{x:EnumChangeEventArg.Change},o)}),o(EnumChangeEventArg.Load)}();const o=$(".persistable[id^=Q12_]");e.scrollTo(o)}}}();$(function(){"Full"===$(".pageTitle").data("systitle").replace(/\s/g,"_")?$(".persistable").each(function(){$(this).prop("disabled",!0)}):(console.log("branching::: LoadAllRules"),branchingController.LoadAllRules())});